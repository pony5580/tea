<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    
    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    
    <!-- Use title if it's in the page YAML frontmatter -->
    <title>Middleman</title>
    
    <link href="stylesheets/normalize.css" relative="true" media="screen" rel="stylesheet" type="text/css" />
<link href="stylesheets/all.css" relative="true" media="screen" rel="stylesheet" type="text/css" />
<link href="stylesheets/md.css" relative="true" media="screen" rel="stylesheet" type="text/css" />
    <script src="javascripts/all.js" relative="true" type="text/javascript"></script>
  </head>
  
  <body class="index2">
    <header id="hero">
      <h1><a class="logo"><img width="225" height="225" alt="Middleman" src="images/mm-blue-w-text.svg"></a></h1>
      <h2>Middlemanで静的サイトの構築環境を作ってみる</h2>
    </header>
    <div class="content">
      <article class="article-body">
      <h1 id="middleman">Middlemanとは?????????</h1>

<p><code>Middleman</code> はRuby製(Sinatra)の静的 Web サイトを作成するためのコマンドラインツールで静的サイトジェネレータ（Static Site Generator）とか呼ばれてます。</p>

<h3 id="jekellhttpjekyllrbcom"><a href="http://jekyllrb.com/">Jekell</a></h3>
<p>一番知られているジェネレーター。これとJekellの機能を拡張する<a href="http://octopress.org/">Octopress</a>の組み合わせで使用する人が多い。</p>

<h3 id="hydehttpringcecomhyde"><a href="http://ringce.com/hyde">Hyde</a></h3>
<p>名前の通りJekellを意識して作られたPython製のジェネレーターでD​​jangoのテンプレートを利用できるようです。
ただ、日本語のドキュメントが少ないのであまり国内では使用してる人はいないみたい。</p>

<h3 id="rootshttprootscx"><a href="http://roots.cx/">roots</a></h3>
<p>node.js製の多機能ジェネレーター。グローバル変数やビューヘルパーなども使えるとあります。
Jade、Stylus、CoffeeScriptをデフォルトで使用できるようになっており、またファイルの変更があれば、自動的にコンパイルする機能もあります。HerokuやGithub Pagesにデプロイする機能もあります。</p>

<h3 id="sculpinhttpssculpinio"><a href="https://sculpin.io/">Sculpin</a></h3>
<p>PHP製のジェネレーター。Jekellに足りない部分を補足する形で作られたらしい。Octopressに近い使用感らしい。</p>

<h2 id="middleman-1">Middlemanで出来ること</h2>

<ul>
  <li>ヘッダー、フッターなど共通部分を共有させることが出来る。　</li>
  <li>HTML内でRubyの文法が使えるHTMLテンプレートエンジンのERBが使える。</li>
  <li>Haml、Slim、Sass、Less、Stylus、CoffeeScriptなどのCSS拡張メタ言語やAltJSが使える。</li>
  <li>開発中は開発コードとプロダクションコードを分離出来る。</li>
  <li>LiveReloadで自動コンパイル。</li>
  <li>便利なTemplate Helpersが使える。</li>
  <li>Asset PipelineでJavascriptやCSSの依存ファイルを管理。</li>
  <li>JavascriptやCSSをminify、gzipなど最適化。</li>
</ul>

<p>などなど</p>

<h2 id="section">インストール</h2>

<p><code>Middleman</code> は <code>RubyGems</code> を使ってインストールできます。</p>

<pre><code>gem install middleman
</code></pre>

<p>簡単！</p>

<pre><code>middleman --help

middleman build [options]           # Builds the static site for deployment
middleman console [options]         # Start an interactive console in the context of your Middleman application
middleman extension NAME [options]  # Create Middleman extension scaffold NAME
middleman init NAME [options]       # Create new project NAME
middleman server [options]          # Start the preview server
middleman upgrade                   # Upgrade installed bundle
middleman version                   # Show version
</code></pre>

<h2 id="section-1">プロジェクトフォルダを作る</h2>

<p>コマンドで新しいサイト用のフォルダを指定することで, 指定フォルダの中にプロジェクトのスケルトンを作ります (場合によってはフォルダも)。</p>

<pre><code>middleman init my_new_project
</code></pre>

<p>以下のスケルトンが作成されます。</p>

<pre><code>my_new_project/
├── Gemfile
├── Gemfile.lock
├── config.rb
└── source
    ├── images
    ├── index.html.erb
    ├── javascripts
    ├── layouts
    └── stylesheets
</code></pre>

<p><strong>Gemfile</strong> - 
	Bundler の Gemfile を使って gem の依存関係の管理。これにより プロジェクトを を特定のリリースシリーズに固定出来る。</p>

<p><strong>Gemfile.lock</strong> - 
	インストール済のGemと依存関係にある Gem を記述。</p>

<p><strong>config.rb</strong> - 
	設定ファイル。</p>

<p><strong>source</strong> - 
	実際に開発していくファイルが格納されていて、ここがビルド対象となります。</p>

<h2 id="section-2">プロジェクトテンプレート</h2>

<p>標準のスケルトン以外に <code>HTML5 Boilerplate</code>, <code>SMACSS</code>, や <code>Mobile Boilerplate</code> ベースのオプションテンプレートが付いています。</p>

<pre><code>middleman init my_new_boilerplate_project --template=html5

middleman init my_new_mobile_project --template=smacss

middleman init my_new_mobile_project --template=mobile
</code></pre>

<p>それ以外にも <a href="http://directory.middlemanapp.com/#/templates/all">コミュニティで開発されたテンプレート</a> も使うことが出来る。</p>

<h2 id="section-3">開発手順</h2>

<p>Middlemanは開発コードとプロダクションコード分離されています、またローカルの Web サーバを起動させ動的に表示
するので都度 build する必要も無い。</p>

<p>開発時は以下のようにプレビューサーバを起動します。</p>

<pre><code>bundle exec middleman server
</code></pre>

<p>このコマンドで Web サーバを起動 <code>http://localhost:4567/</code></p>

<h2 id="section-4">静的サイトのエクスポート</h2>

<p>編集したファイルをサーバー側に送りたい場合は静的ページを出力します。</p>

<pre><code>bundle exec middleman build
</code></pre>

<h1 id="section-5">テンプレート</h1>

<p>Middlemanでは基本はテンプレート言語 ERbを使用し Template , layout , partial　という構成で構築されます。</p>

<h1 id="section-6">アセットパイプライン</h1>

<h3 id="section-7">依存性管理</h3>

<p>Sprockets は Javascript (と CoffeeScript) のライブラリを管理するためのツールで, 依存性を宣言し 3rd パーティのコードを読み込みます。Sprockets は .js や .coffee のファイルの中で, require メソッドを使えるようにし, プロジェクトまたは 3rd パーティ製の gem から外部ファイルを取り込むことができます。</p>

<h1 id="section-8">サイトマップ</h1>

<p>テンプレートからアクセスできる, サイト内のすべてのページとリソース, それらが互いにどのように関係するか情報を持つサイトマップ。</p>

<p><a href="http://localhost:4567/__middleman/sitemap/">サイトマップ</a></p>


      </article>
    </div>
    <footer id="footer">
      <div class="container">
      </div>
    </footer>
  </body>
</html>